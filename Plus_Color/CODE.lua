--https://wago.tools/db2/GlobalColor
local Tab={
"ACCOUNT_WIDE_FONT_COLOR",
"ACHIEVEMENT_COLOR",
"ACHIEVEMENT_COMPLETE_COLOR",
"ACHIEVEMENT_INCOMPLETE_COLOR",
"ACTIONBAR_HOTKEY_FONT_COLOR",
"ADVENTURES_BUFF_BLUE",
"ADVENTURES_COMBAT_LOG_BLUE",
"ADVENTURES_COMBAT_LOG_GREY",
"ADVENTURES_COMBAT_LOG_ORANGE",
"ADVENTURES_COMBAT_LOG_YELLOW",
"ADVENTURES_HEALING_GREEN",
"ARCHAEOLOGY_BROWN",
"ARCHAEOLOGY_LIGHT_BROWN",
"AREA_DESCRIPTION_FONT_COLOR",
"AREA_DESCRIPTION_FONT_COLOR",
"AREA_NAME_FONT_COLOR",
"ARENA_NAME_FONT_COLOR",
"ARTIFACT_BAR_COLOR",
"ARTIFACT_GOLD_COLOR",
"AZERITE_ESSENCE_COLOR",
"AZERITE_SUBTEXT_COLOR",
"BANK_BAG_BACKGROUND_COLOR",
"BATTLE_TAG_FONT_COLOR",
"BATTLE_TAG_SUFFIX_FONT_COLOR",
"BATTLENET_FONT_COLOR",
"BATTLEPET_ABILITY_LINK_COLOR",
"BIND_TRADE_TOOLTIP_COLOR",
"BLACK_FONT_COLOR",
"BLUE_FONT_COLOR",
"BRIGHTBLUE_FONT_COLOR",
"BRONZE_MATERIAL_TEXT_COLOR",
"BRONZE_MATERIAL_TITLETEXT_COLOR",
"CAMPAIGN_COMPLETE_COLOR",
"CANDLE_MAJOR_FACTION_COLOR",
"CENTAUR_MAJOR_FACTION_COLOR",
"CHALLENGE_MODE_TOAST_TITLE_COLOR",
"CINEMATIC_SUBTITLES_BLACK_BACKGROUND_COLOR",
"CINEMATIC_SUBTITLES_LIGHT_BACKGROUND_COLOR",
"COMBAT_TEXT_PET_COLOR",
"COMBAT_TEXT_SPELL_COLOR",
"COMMON_GRAY_COLOR",
"CONTEXT_FEEDBACK_COLOR",
"CORRUPTION_COLOR",
"CUSTOMIZATION_CHOICE_ELIGIBLE_COLOR",
"CUSTOMIZATION_CHOICE_INELIGIBLE_COLOR",
"DARKGRAY_COLOR",
"DARKYELLOW_FONT_COLOR",
"DECREASE_STAT_COLOR",
"DEFAULT_CHAT_CHANNEL_COLOR",
"DEFAULT_MATERIAL_TEXT_COLOR",
"DEFAULT_MATERIAL_TITLETEXT_COLOR",
"DELVES_SCENARIO_NAME_COLOR",
"DELVES_SEASONAL_LEVEL_BLUE_COLOR",
"DIFFICULT_DIFFICULTY_COLOR",
"DIM_GREEN_FONT_COLOR",
"DIM_RED_FONT_COLOR",
"DISABLED_REAGENT_COLOR",
"DRAGONFLIGHT_BLACK_COLOR",
"DRAGONFLIGHT_BLUE_COLOR",
"DRAGONFLIGHT_BRONZE_COLOR",
"DRAGONFLIGHT_GREEN_COLOR",
"DRAGONFLIGHT_RED_COLOR",
"DREAM_MAJOR_FACTION_COLOR",
"DULL_RED_FONT_COLOR",
"EASY_DIFFICULTY_COLOR",
"EDIT_MODE_GRID_CENTER_LINE_COLOR",
"EDIT_MODE_GRID_LINE_COLOR",
"EDIT_MODE_LAYOUT_LINK_COLOR",
"EJ_SPELL_COLOR",
"ENCHANT_COLOR",
"ENCOUNTER_JOURNAL_SCROLL_BAR_BACKGROUND_COLOR",
"ENHANCED_CONDUIT_COLOR",
"EPIC_PURPLE_COLOR",
"ERROR_COLOR",
"EVENT_SCHEDULER_LOCATION_COLOR",
"EVENT_SCHEDULER_NAME_COLOR",
"EXPANSION_COLOR_1",
"EXPANSION_COLOR_10",
"EXPANSION_COLOR_11",
"EXPANSION_COLOR_12",
"EXPANSION_COLOR_13",
"EXPANSION_COLOR_2",
"EXPANSION_COLOR_3",
"EXPANSION_COLOR_4",
"EXPANSION_COLOR_5",
"EXPANSION_COLOR_6",
"EXPANSION_COLOR_7",
"EXPANSION_COLOR_8",
"EXPANSION_COLOR_9",
"EXPEDITION_MAJOR_FACTION_COLOR",
"FACTION_AT_WAR_COLOR",
"FACTION_GREEN_COLOR",
"FACTION_ORANGE_COLOR",
"FACTION_RED_COLOR",
"FACTION_YELLOW_COLOR",
"FAIR_DIFFICULTY_COLOR",
"FLAME_MAJOR_FACTION_COLOR",
"FRAMESTACK_FRAME_COLOR",
"FRAMESTACK_HIDDEN_COLOR",
"FRAMESTACK_REGION_COLOR",
"FRIENDLY_STATUS_COLOR",
"FRIENDS_BNET_BACKGROUND_COLOR",
"FRIENDS_BNET_NAME_COLOR",
"FRIENDS_BROADCAST_TIME_COLOR",
"FRIENDS_GRAY_COLOR",
"FRIENDS_OFFLINE_BACKGROUND_COLOR",
"FRIENDS_OTHER_NAME_COLOR",
"FRIENDS_WOW_BACKGROUND_COLOR",
"FRIENDS_WOW_NAME_COLOR",
"GLUE_DIALOG_FONT_COLOR",
"GLYPH_LINK_COLOR",
"GOLD_FONT_COLOR",
"GRAY_FONT_COLOR",
"GREEN_FONT_COLOR",
"HEALTHBAR_HEAL_ABSORB_COLOR",
"HEALTHBAR_MY_HEAL_PREDICTION_COLOR",
"HEALTHBAR_OTHER_HEAL_PREDICTION_COLOR",
"HEALTHBAR_TOTAL_ABSORB_COLOR",
"HEIRLOOM_BLUE_COLOR",
"HIGHLIGHT_LIGHT_BLUE",
"HOSTILE_STATUS_COLOR",
"IMPOSSIBLE_DIFFICULTY_COLOR",
"INACTIVE_COLOR",
"INCREASE_STAT_COLOR",
"INFLUENCE_COLOR",
"INSTANCE_LOCK_LINK_COLOR",
"INVALID_EQUIPMENT_COLOR",
"INVASION_DESCRIPTION_FONT_COLOR",
"INVASION_DESCRIPTION_FONT_COLOR",
"INVASION_FONT_COLOR",
"INVASION_FONT_COLOR",
"ITEM_ARTIFACT_COLOR",
"ITEM_EPIC_COLOR",
"ITEM_GOOD_COLOR",
"ITEM_LEGENDARY_COLOR",
"ITEM_POOR_COLOR",
"ITEM_SCALING_STAT_COLOR",
"ITEM_STANDARD_COLOR",
"ITEM_SUPERIOR_COLOR",
"ITEM_WOW_TOKEN_COLOR",
"JOURNAL_LINK_COLOR",
"KARESH_TRUST_MAJOR_FACTION_FONT_COLOR",
"KYRIAN_BLUE_COLOR",
"LEGENDARY_ORANGE_COLOR",
"LEGION_GREEN",
"LEGION_REMIX_FACTION_BURNING_LEGION",
"LEGION_REMIX_FACTION_DROGBAR",
"LEGION_REMIX_FACTION_INFINITE",
"LEGION_REMIX_FACTION_KIRIN_TOR",
"LEGION_REMIX_FACTION_NAGA",
"LEGION_REMIX_FACTION_NIGHTFALLEN",
"LEGION_REMIX_FACTION_TIDESKORN",
"LEGION_REMIX_FACTION_WARDENS",
"LIGHTBLUE_FONT_COLOR",
"LIGHTERBLUE_FONT_COLOR",
"LIGHTERGRAY_FONT_COLOR",
"LIGHTGRAY_FONT_COLOR",
"LIGHTYELLOW_FONT_COLOR",
"LINK_FONT_COLOR",
"LOOT_LINK_COLOR",
"LORE_TEXT_BODY_COLOR",
"MANAFORGE_VANDALS_MAJOR_FACTION_FONT_COLOR",
"MARBLE_MATERIAL_TEXT_COLOR",
"MARBLE_MATERIAL_TITLETEXT_COLOR",
"NECROLORD_GREEN_COLOR",
"NEUTRAL_STATUS_COLOR",
"NEW_FEATURE_SHADOW_COLOR",
"NIFFEN_MAJOR_FACTION_COLOR",
"NIGHT_FAE_BLUE_COLOR",
"NIGHTFALL_MAJOR_FACTION_COLOR",
"NO_THREAT_COLOR",
"NOT_ON_THREAT_COLOR",
"OBJECTIVE_TRACKER_BLOCK_HEADER_COLOR",
"ORANGE_FONT_COLOR",
"ORANGE_THREAT_COLOR",
"PANEL_BACKGROUND_COLOR",
"PAPER_FRAME_COLLAPSED_COLOR",
"PAPER_FRAME_DARK_COLOR",
"PAPER_FRAME_EXPANDED_COLOR",
"PAPER_FRAME_TEXT_COLOR",
"PAPER_FRAME_TITLE_COLOR",
"PARCHMENT_MATERIAL_TEXT_COLOR",
"PARCHMENT_MATERIAL_TITLETEXT_COLOR",
"PARCHMENTLARGE_MATERIAL_TEXT_COLOR",
"PARCHMENTLARGE_MATERIAL_TITLETEXT_COLOR",
"PASSIVE_SPELL_FONT_COLOR",
"PLAYER_FACTION_COLOR_ALLIANCE",
"PLAYER_FACTION_COLOR_HORDE",
"PLAYER_NAMEPLATE_ALTERNATE_HEALTH_COLOR",
"PLUNDERSTORM_WANTED_COLOR",
"POWERBAR_PREDICTION_COLOR_ENERGY",
"POWERBAR_PREDICTION_COLOR_FOCUS",
"POWERBAR_PREDICTION_COLOR_FURY",
"POWERBAR_PREDICTION_COLOR_INSANITY",
"POWERBAR_PREDICTION_COLOR_LUNAR_POWER",
"POWERBAR_PREDICTION_COLOR_MAELSTROM",
"POWERBAR_PREDICTION_COLOR_MANA",
"POWERBAR_PREDICTION_COLOR_PAIN",
"POWERBAR_PREDICTION_COLOR_RAGE",
"POWERBAR_PREDICTION_COLOR_RUNIC_POWER",
"PROFESSION_RECIPE_COLOR",
"PROFESSION_SPEC_COLOR_ALCHEMY",
"PROFESSION_SPEC_COLOR_ARCHAEOLOGY",
"PROFESSION_SPEC_COLOR_BLACKSMITHING",
"PROFESSION_SPEC_COLOR_COOKING",
"PROFESSION_SPEC_COLOR_ENCHANTING",
"PROFESSION_SPEC_COLOR_ENGINEERING",
"PROFESSION_SPEC_COLOR_FIRST_AID",
"PROFESSION_SPEC_COLOR_FISHING",
"PROFESSION_SPEC_COLOR_HERBALISM",
"PROFESSION_SPEC_COLOR_INSCRIPTION",
"PROFESSION_SPEC_COLOR_JEWELCRAFTING",
"PROFESSION_SPEC_COLOR_LEATHERWORKING",
"PROFESSION_SPEC_COLOR_MINING",
"PROFESSION_SPEC_COLOR_SKINNING",
"PROFESSION_SPEC_COLOR_TAILORING",
"PROFESSIONS_JEWELCRAFTING_GEMSTONES_AMBER",
"PROFESSIONS_JEWELCRAFTING_GEMSTONES_CITRINE",
"PROFESSIONS_JEWELCRAFTING_GEMSTONES_EMERALD",
"PROFESSIONS_JEWELCRAFTING_GEMSTONES_ONYX",
"PROFESSIONS_JEWELCRAFTING_GEMSTONES_RUBY",
"PROFESSIONS_JEWELCRAFTING_GEMSTONES_SAPPHIRE",
"PROGENITOR_MATERIAL_TEXT_COLOR",
"PROGENITOR_MATERIAL_TITLETEXT_COLOR",
"PURE_BLUE_COLOR",
"PURE_GREEN_COLOR",
"PURE_RED_COLOR",
"PURE_RED_COLOR",
"PVP_SCOREBOARD_ALLIANCE_ALT_CELL_COLOR",
"PVP_SCOREBOARD_ALLIANCE_ALT_ROW_COLOR",
"PVP_SCOREBOARD_ALLIANCE_CELL_COLOR",
"PVP_SCOREBOARD_ALLIANCE_ROW_COLOR",
"PVP_SCOREBOARD_HORDE_ALT_CELL_COLOR",
"PVP_SCOREBOARD_HORDE_ALT_ROW_COLOR",
"PVP_SCOREBOARD_HORDE_CELL_COLOR",
"PVP_SCOREBOARD_HORDE_ROW_COLOR",
"QUEST_ACCOUNT_COMPLETED_NOTICE_FONT_COLOR",
"QUEST_ACTIVE_TRIVIAL_GRAY",
"QUEST_INELIGIBLE_GRAY",
"QUEST_OBJECTIVE_COMPLETED_FONT_COLOR",
"QUEST_OBJECTIVE_COMPLETED_FONT_COLOR_DARK_BACKGROUND",
"QUEST_OBJECTIVE_DISABLED_FONT_COLOR",
"QUEST_OBJECTIVE_DISABLED_HIGHLIGHT_FONT_COLOR",
"QUEST_OBJECTIVE_FONT_COLOR",
"QUEST_OBJECTIVE_HIGHLIGHT_FONT_COLOR",
"QUEST_REWARD_CONTEXT_FONT_COLOR",
"RAF_VERSION_THREE_COLOR",
"RAF_VERSION_TWO_COLOR",
"RARE_BLUE_COLOR",
"RARE_MISSION_COLOR",
"RECENT_ALLY_FONT_COLOR",
"RED_FONT_COLOR",
"RED_THREAT_COLOR",
"REFUND_TOOLTIP_COLOR",
"REFUND_TOOLTIP_COLOR",
"ROCKET_MAJOR_FACTION_COLOR",
"RPE_FONT_COLOR",
"RUNEFORGE_LEGEDARY_SPEC_COLOR",
"SCENARIO_STAGE_COLOR",
"SCENARIO_SUBTITLE_COLOR",
"SEPIA_COLOR",
"SET_ITEM_COLOR",
"SILVER_MATERIAL_TEXT_COLOR",
"SILVER_MATERIAL_TITLETEXT_COLOR",
"SOULBIND_CONDUIT_ENHANCED_COLOR",
"SPELL_LINK_COLOR",
"SPELL_SUBTEXT_COLOR",
"SPELLBOOK_FONT_COLOR",
"SPELLBOOK_UNLEARNED_TINT_COLOR",
"STARS_MAJOR_FACTION_COLOR",
"STONE_MATERIAL_TEXT_COLOR",
"STONE_MATERIAL_TITLETEXT_COLOR",
"STORM_MAJOR_FACTION_COLOR",
"SUBSCRIPTION_INTERSTITIAL_COLOR",
"TALENT_LINK_COLOR",
"TOOLTIP_DEFAULT_BACKGROUND_COLOR",
"TOOLTIP_DEFAULT_COLOR",
"TOY_LINK_COLOR",
"TRADESKILL_EXPERIENCE_COLOR",
"TRANSMOGRIFY_COLOR",
"TRANSMOGRIFY_FONT_COLOR",
"TRIVIAL_DIFFICULTY_COLOR",
"TUSKARR_MAJOR_FACTION_COLOR",
"TUTORIAL_BLUE_FONT_COLOR",
"TUTORIAL_FONT_COLOR",
"UI_TOOLS_DISABLED_COLOR",
"UI_TOOLS_LINE_COLOR",
"UI_TOOLS_PRESSED_BUTTON_COLOR",
"UNCOMMON_GREEN_COLOR",
"USED_IN_TRADESKILL_COLOR",
"VALDRAKKEN_MAJOR_FACTION_COLOR",
"VENTHYR_RED_COLOR",
"VERY_DARK_GRAY_COLOR",
"VERY_LIGHT_GRAY_COLOR",
"WARBOARD_OPTION_TEXT_COLOR",
"WEB_MAJOR_FACTION_COLOR",
"WHITE_FONT_COLOR",
"YELLOW_FONT_COLOR",
"YELLOW_THREAT_COLOR",
}




local function Init_Menu(self, root)
    if not self:IsMouseOver() then
        return
    end

    
    local text= string.upper(self:GetParent():GetText() or ' ')
    
    local sub
    for _, name in pairs(Tab) do
        local color = _G[name..'_CODE']
        if color and _G[name] then
            sub=root:CreateRadio (
                color..name,
            function(data)
                local t= string.upper(self:GetParent():GetText() or '')
                return t==data.name or (_G[t] and _G[t].GenerateHexColorMarkup and _G[t]:GenerateHexColorMarkup()==_G[data.name]:GenerateHexColorMarkup())
            end, function(data)
                local edit= self:GetParent()
                edit:SetText(data.name..'_CODE')
                edit:Setup()
                return MenuResponse.Refresh
            end, {name=name})
            sub:SetTooltip(function(tooltip, desc)
                tooltip:AddLine(desc.data.name..'_CODE')
                tooltip:AddDoubleLine('|c',_G[desc.data.name..'_CODE']:gsub('|c', ''), 1,1,1, 1,1,1)
            end)
        end
    end

--SetScrollMod
    WoWTools_MenuMixin:SetScrollMode(root)
end


local function Init(edit)
    if not edit then
        Tab={}
        return
    end

    table.sort(Tab)


    --[[local tab={
        [DISABLED_FONT_COLOR:GenerateHexColorMarkup()]=1,
        [WARNING_FONT_COLOR:GenerateHexColorMarkup()]=1,
        [HIGHLIGHT_FONT_COLOR:GenerateHexColorMarkup()]=1,
        [NORMAL_FONT_COLOR:GenerateHexColorMarkup()]=1
    }

    do
        for index, name in pairs(Tab) do
            if _G[name] and _G[name].GenerateHexColorMarkup then
                local col= _G[name]:GenerateHexColorMarkup()
                if tab[col] then
                    table.remove(Tab, index)
                    print(col, name)
                else
                    tab[col]=1
                end
            else
                table.remove(Tab, index)
            end
        end
    end
    tab= nil]]
    table.insert(Tab, 1, "DISABLED_FONT_COLOR")
    table.insert(Tab, 1, "WARNING_FONT_COLOR")
    table.insert(Tab, 1, "HIGHLIGHT_FONT_COLOR")
    table.insert(Tab, 1, "NORMAL_FONT_COLOR")


    local btn= WoWTools_ButtonMixin:Menu(edit, {atlas='AnimaChannel-Bar-Necrolord-Gem'})
    btn:SetPoint('RIGHT', edit.Instructions, 'LEFT')
    btn:SetupMenu(Init_Menu)

    Init=function()end
end



function WoWTools_ColorMixin:Init_CODE(edit)
    Init(edit)
end